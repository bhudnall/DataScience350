## Monty Hall Simulation

#### By Brian Hudnall

##### Executive Summary: The Monty Hall problem is a brain teaser, in the form of a probability puzzle (Gruber, Krauss and others), loosely based on the American television game show Let's Make a Deal. You're given the choice of three doors: Behind one door is a car; behind the others, goats. You pick a door, say No. 1, and the host, who knows what's behind the doors, opens another door, say No. 3, which has a goat. He then says to you, "Do you want to pick door No. 2?" Is it to your advantage to switch your choice? [Monty_Hall_problem](https://en.wikipedia.org/wiki/Monty_Hall_problem)

##### Results: The simulation proves that it's smarter to switch doors. This was previously proven by Vos Savant. Whose response was that the contestant should switch to the other door.

#### Function creation:

Load the necessary packages used in analysis.
```{r message=FALSE, warning=FALSE}
set.seed(42)
library(dplyr)
library(ggplot2)
```
Create a function that simulates the initial choices, which door the car is behind, and if the contestant either switches or stays.
```{r}
sim_n <- 1000

sim_initial_choice <- function(n = sim_n) {
        
        door_choice <- runif(n)
        door_choice <- ifelse(door_choice <= 1/3, 1
               , ifelse(door_choice <= 2/3, 2, 3))
        car <- runif(n)
        car <- ifelse(car <= 1/3, 1
                      , ifelse(car <= 2/3, 2, 3))
        final_choice <- runif(n)
        final_choice <- ifelse(final_choice <= 1/2, 'switch', 'stay')
        df <- data.frame(door_choice, car, final_choice)
}
```
The next function will determine if the contestant had success or failure depending on if they switched or stayed and the location of the car.
```{r}
## This simulates the choice a contestant would make 
## assuming the car is behind door #1 and they choose to make a switch
sim_result <- function(df = sim_df) {
        
        df[,4] <- NA;
        names(df)[4] <- "result"
        for(i in 1:nrow(df)) {
                if(df[i,"final_choice"] == "stay") {
                        if(df[i,"door_choice"] == df[i, "car"]) {
                                df[i, "result"] <- 1
                        }
                        else {
                                df[i, "result"] <- 0
                        }
                }
                else {
                        if(df[i, "door_choice"] != df[i, "car"]) {
                                df[i, "result"] <- 1
                        }
                        else {
                                df[i, "result"] <- 0
                        }
                        
                }
        }
        df
}
```
This next function will calculate the mean and variance of the results.
```{r}
## summarise the results and return a Data Frame
## also add a column for the probability of results 
## given a car or a goat output
result_summary <- function(df) {
        
        df <- df %>%
                group_by(final_choice) %>%
                summarise(probability = mean(result), variance = var(result))
        
}
```
This last function will plot the results.
```{r}
## Plot the initial results
plot_summary <- function(df) {
        
        ggplot(df, aes(x = final_choice, y = probability)) +
                geom_bar(stat = "identity") 
        
}
```
#### Run simulation:

We now utilize these functions to plot the simulation and calculate the probability and variance of either staying or switching doors.
```{r}

## First we create the data set that contains random contestant selections, car door assignment, and stay or switch
df <- sim_initial_choice(sim_n)
summary(df)
head(df)

## Run the sum_result function to see what the results are
df <- sim_result(df)
summary(df)
head(df)

## Now calculate the probability and the variance
df <- result_summary(df)
summary(df)
head(df)

## Plot the results
plot_summary(df)
```


